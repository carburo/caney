{% extends "base_bare.html.twig" %}

{% block title %}
    {% trans %}hostels.title{% endtrans %}{#: {{ destination.name }} #}
{% endblock %}

{% block content %}
    <section id="search" style="padding-top: 2em">
        <div class="container">
            <div class="row">
                    <div id="bloodhound" class="col-md-12" style="text-align: center">
                        <form id="search-form">
                            <input id="search-box" type="text" class="typeahead" placeholder="Type a city, a place to go" value="{{ query }}"/>
                        </form>
                    </div>
            </div>
        </div>
    </section>
    <section id="hostel-gallery">
        <div class="container" id="hostel-gallery-container">
            {{ include('hostel/gallery_content.html.twig') }}
        </div>
    </section>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        // constructs the suggestion engine
        var states = new Bloodhound({
            datumTokenizer: Bloodhound.tokenizers.whitespace,
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            prefetch: '/api/en/searches.json'
        });

        $('#bloodhound .typeahead').typeahead({
                    hint: true,
                    highlight: true,
                    minLength: 1
                },
                {
                    name: 'states',
                    source: states
                });
    </script>
    <script>
        $('.typeahead').bind('typeahead:select', function(ev, suggestion) {
            $('#loader').fadeIn();
            var $query = suggestion;
            $.get(Routing.generate('hostel_search', { query: $query, _locale: '{{ app.request.locale }}' }), $(this).serialize(), function(data) {
                $('#hostel-gallery-container').html(data);
                $('#loader').fadeOut();
            });
        });
    </script>
{% endblock %}